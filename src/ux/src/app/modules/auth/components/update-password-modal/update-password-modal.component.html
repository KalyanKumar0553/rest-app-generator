<div class="modal-overlay" (click)="onClose()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="onClose()" aria-label="Close modal">
      <i class="bi bi-x-lg"></i>
    </button>

    <div class="modal-header">
      <h2>Update Password</h2>
    </div>

    <div class="modal-body">
      <p class="modal-description">
        Enter the 6-digit OTP sent to {{ email }} and set your new password.
      </p>

      <form (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="otp">OTP</label>
          <input
            id="otp"
            name="otp"
            type="text"
            maxlength="6"
            autocomplete="one-time-code"
            [(ngModel)]="otp"
            (input)="onOtpInput()"
            (blur)="onOtpBlur()"
            class="form-control"
            placeholder="Enter 6-digit code"
            [class.error]="otpError"
            [disabled]="isLoading"
          />
          <span class="error-message" *ngIf="otpError">{{ otpError }}</span>
        </div>

        <div class="form-group">
          <label for="newPassword">New Password</label>
          <input
            id="newPassword"
            name="newPassword"
            type="password"
            [(ngModel)]="newPassword"
            (blur)="onPasswordBlur()"
            class="form-control"
            placeholder="Enter new password"
            [class.error]="passwordError"
            [disabled]="isLoading"
          />
          <span class="error-message" *ngIf="passwordError">{{ passwordError }}</span>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Re-type Password</label>
          <input
            id="confirmPassword"
            name="confirmPassword"
            type="password"
            [(ngModel)]="confirmPassword"
            (blur)="onConfirmPasswordBlur()"
            class="form-control"
            placeholder="Re-enter new password"
            [class.error]="confirmPasswordError"
            [disabled]="isLoading"
          />
          <span class="error-message" *ngIf="confirmPasswordError">{{ confirmPasswordError }}</span>
        </div>

        <button
          type="submit"
          class="btn-submit"
          [disabled]="!isFormValid() || isLoading"
        >
          <span *ngIf="!isLoading">Update password</span>
          <span *ngIf="isLoading" class="loading-spinner">
            <i class="bi bi-arrow-repeat spinner-icon"></i>
            Updating...
          </span>
        </button>
      </form>
    </div>
  </div>
</div>
