<div class="modal-overlay" (click)="closeModal()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-content">
      <div class="modal-header">
        <h2>OTP verification</h2>
        <p class="description">
          Please enter the OTP (One-Time Password) sent to your registered email/phone number to complete your verification.
        </p>
      </div>

      <div class="modal-body">
        <div class="otp-input-group">
          <input
            *ngFor="let digit of otpDigits; let i = index"
            [id]="'otp-' + i"
            type="text"
            maxlength="1"
            class="otp-input"
            [(ngModel)]="otpDigits[i]"
            (input)="onOtpInput($event, i)"
            (keydown)="onOtpKeyDown($event, i)"
            (paste)="i === 0 ? onOtpPaste($event) : null"
            [disabled]="isLoading"
            inputmode="numeric"
            pattern="[0-9]"
          />
        </div>

        <div class="timer-resend-section">
          <div class="timer-text">
            <span class="label">Remaining time:</span>
            <span class="time">{{ formattedTime }}</span>
          </div>
          <div class="resend-text">
            <span class="label">Didn't get the code?</span>
            <button
              class="resend-link"
              (click)="resendOTP()"
              [disabled]="!canResend || isLoading"
            >
              {{ canResend ? 'Resend' : 'Resend' }}
            </button>
          </div>
        </div>

        <div class="button-group">
          <button
            class="btn btn-verify"
            (click)="verifyOTP()"
            [disabled]="!isOtpComplete || isLoading"
          >
            <span *ngIf="!isLoading">Verify</span>
            <span *ngIf="isLoading" class="loading-spinner">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2" opacity="0.25"/>
                <path d="M10 2C5.58172 2 2 5.58172 2 10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Verifying...
            </span>
          </button>

          <button
            class="btn btn-cancel"
            (click)="closeModal()"
            [disabled]="isLoading"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
