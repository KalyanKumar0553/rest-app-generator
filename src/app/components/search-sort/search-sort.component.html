<div class="search-sort-container">
  <div class="search-box">
    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
      <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
    </svg>
    <input
      type="text"
      class="search-input"
      [placeholder]="searchConfig.placeholder"
      [(ngModel)]="searchTerm"
      (ngModelChange)="onSearchChange()"
    />
    <button
      *ngIf="searchTerm"
      class="clear-btn"
      (click)="clearSearch()"
      aria-label="Clear search"
    >
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
    </button>
  </div>

  <div class="sort-container">
    <div #sortButton class="sort-button" [class.active]="selectedSortOption">
      <button
        class="sort-main-btn"
        (click)="toggleDropdown()"
        aria-label="Sort options"
      >
        <svg class="sort-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 6h18M3 12h15M3 18h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span class="sort-label">{{ getSortLabel() }}</span>
        <svg class="chevron" [class.open]="isDropdownOpen" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button
        *ngIf="selectedSortOption"
        class="clear-sort-btn"
        (click)="clearSort($event)"
        aria-label="Clear sort"
      >
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    <div class="dropdown-overlay" *ngIf="isDropdownOpen" (click)="closeDropdown()"></div>
    <div class="dropdown-menu" [class.open]="isDropdownOpen" [style.top]="dropdownPosition.top" [style.right]="dropdownPosition.right">
      <div *ngFor="let prop of uniqueSortProperties" class="dropdown-group">
        <div class="dropdown-item-wrapper">
          <span class="property-label">{{ prop.label }}</span>
          <div class="direction-buttons">
            <button
              class="direction-btn"
              [class.selected]="isDirectionSelected(prop.property, 'asc')"
              (click)="onSortSelect(prop.property, 'asc')"
              aria-label="Sort ascending"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 19V5M5 12l7-7 7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button
              class="direction-btn"
              [class.selected]="isDirectionSelected(prop.property, 'desc')"
              (click)="onSortSelect(prop.property, 'desc')"
              aria-label="Sort descending"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 5v14M5 12l7 7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
